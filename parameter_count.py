#%%
# Formulas:
def conv_N_params(in_c,out_c,kernal_size=3):
    kernal_area = kernal_size**2
    return (in_c*kernal_area+1)*out_c

def lin_N_params(in_c,out_c):
    return in_c*out_c

## CONV ###
conv_params = [[3,32],
    [32,32],
    [32,32],
    [32,32],
    [32,32],
    [32,64],
    [64,64],
    [64,64],
    [64,64],
    [128,64],
    [64,64],
    [128,64],
    [64,64],
    [96,64],
    [64,64],
    [96,32],
    [32,32],
    [64,32],
    [32,32],
    [64,32],
    [32,32],
    [32,3]]

conv_count = 0
for param in conv_params:
    conv_count += conv_N_params(param[0],param[1])

lin_params = [[32,128] ,
[128,128] ,
[32,32],
[32,32],
[64,64] ,
[64,64] ,
[64,64] ,
[64,64] ,
[64,64] ,
[32,32] ,
[32,32] ,
[32,32] ,
[128,32],
[128,32],
[128,64] ,
[128,64] ,
[128,64] ,
[128,64] ,
[128,64] ,
[128,32] ,
[128,32] ,
[128,32] ,
[64,64] ,
[64,64] ,
[64,64] ,
[64,64] ,
[64,64] ,
[64,64] ,
[64,64] ,
[64,64] ,
[64,64] ,
[64,64] ,
[64,64] ,
[64,64] ,
[64,64] ,
[64,64] ,
[64,64] ,
[64,64] ,
[64,64] ,
[64,64] ,
[64,64] ,
[64,64] ,
[64,64] ,
[64,64] ,
[64,64] ,
[64,64]]
lin_count = 0
for param in lin_params:
    lin_count += lin_N_params(param[0],param[1])

true_model_count  = lin_count+ conv_count

#%%
giant_dummy_params = [[128, 3072],
[256, 128],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[256, 256],
[512, 256],
[3072, 512]]

count = 0
for param in giant_dummy_params:
    count += lin_N_params(param[0],param[1])

count
# %%

true_model_count
